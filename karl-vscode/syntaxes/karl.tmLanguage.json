{
    "$schema": "https://raw.githubusercontent.com/martinring/tmlanguage/master/tmlanguage.json",
    "name": "Karl",
    "scopeName": "source.karl",
    "patterns": [
        {
            "include": "#comments"
        },
        {
            "include": "#keywords"
        },
        {
            "include": "#operators"
        },
        {
            "include": "#strings"
        },
        {
            "include": "#numbers"
        },
        {
            "include": "#constants"
        },
        {
            "include": "#functions"
        },
        {
            "include": "#builtins"
        },
        {
            "include": "#punctuation"
        }
    ],
    "repository": {
        "comments": {
            "patterns": [
                {
                    "name": "comment.line.double-slash.karl",
                    "match": "//.*$"
                }
            ]
        },
        "keywords": {
            "patterns": [
                {
                    "name": "keyword.control.karl",
                    "match": "\\b(if|else|for|while|break|continue|return|match|case|then|with|wait)\\b"
                },
                {
                    "name": "keyword.other.karl",
                    "match": "\\b(let|import|from|in|where|orderby|select)\\b"
                },
                {
                    "name": "keyword.operator.async.karl",
                    "match": "&(?!&)"
                },
                {
                    "name": "keyword.operator.race.karl",
                    "match": "!&"
                }
            ]
        },
        "operators": {
            "patterns": [
                {
                    "name": "keyword.operator.arrow.karl",
                    "match": "->"
                },
                {
                    "name": "keyword.operator.comparison.karl",
                    "match": "(==|!=|<=|>=|<|>)"
                },
                {
                    "name": "keyword.operator.logical.karl",
                    "match": "(&&|\\|\\|)"
                },
                {
                    "name": "keyword.operator.arithmetic.karl",
                    "match": "(\\+|\\-|\\*|/|%)"
                },
                {
                    "name": "keyword.operator.assignment.karl",
                    "match": "(\\+=|\\-=|\\*=|/=|%=|=)"
                },
                {
                    "name": "keyword.operator.error-recovery.karl",
                    "match": "\\?"
                },
                {
                    "name": "keyword.operator.range.karl",
                    "match": "\\.\\."
                },
                {
                    "name": "keyword.operator.increment.karl",
                    "match": "(\\+\\+|\\-\\-)"
                }
            ]
        },
        "strings": {
            "patterns": [
                {
                    "name": "string.quoted.double.karl",
                    "begin": "\"",
                    "end": "\"",
                    "patterns": [
                        {
                            "name": "constant.character.escape.karl",
                            "match": "\\\\(n|r|t|\\\\|\"|')"
                        }
                    ]
                },
                {
                    "name": "string.quoted.single.karl",
                    "begin": "'",
                    "end": "'",
                    "patterns": [
                        {
                            "name": "constant.character.escape.karl",
                            "match": "\\\\(n|r|t|\\\\|\"|')"
                        }
                    ]
                }
            ]
        },
        "numbers": {
            "patterns": [
                {
                    "name": "constant.numeric.decimal.karl",
                    "match": "\\b\\d+(\\.\\d+)?\\b"
                },
                {
                    "name": "constant.numeric.hex.karl",
                    "match": "\\b0[xX][0-9a-fA-F]+\\b"
                }
            ]
        },
        "constants": {
            "patterns": [
                {
                    "name": "constant.language.boolean.karl",
                    "match": "\\b(true|false)\\b"
                },
                {
                    "name": "constant.language.null.karl",
                    "match": "\\b(nil|null)\\b"
                }
            ]
        },
        "builtins": {
            "patterns": [
                {
                    "name": "support.function.builtin.karl",
                    "match": "\\b(log|sleep|fail|http|jsonDecode|jsonEncode|map|set|rendezvous)\\b"
                },
                {
                    "name": "support.function.string.karl",
                    "match": "\\b(trim|toLower|toUpper|split|chars|contains|startsWith|endsWith|replace)\\b"
                },
                {
                    "name": "support.function.array.karl",
                    "match": "\\b(map|filter|reduce|sum|find|sort|length)\\b"
                },
                {
                    "name": "support.function.channel.karl",
                    "match": "\\b(send|recv|done|then)\\b"
                }
            ]
        },
        "functions": {
            "patterns": [
                {
                    "name": "entity.name.function.karl",
                    "match": "\\b([a-zA-Z_][a-zA-Z0-9_]*)\\s*(?=\\()"
                }
            ]
        },
        "punctuation": {
            "patterns": [
                {
                    "name": "punctuation.separator.comma.karl",
                    "match": ","
                },
                {
                    "name": "punctuation.terminator.semicolon.karl",
                    "match": ";"
                },
                {
                    "name": "punctuation.accessor.karl",
                    "match": "\\."
                },
                {
                    "name": "meta.brace.curly.karl",
                    "match": "[{}]"
                },
                {
                    "name": "meta.brace.square.karl",
                    "match": "[\\[\\]]"
                },
                {
                    "name": "meta.brace.round.karl",
                    "match": "[()]"
                }
            ]
        }
    }
}
